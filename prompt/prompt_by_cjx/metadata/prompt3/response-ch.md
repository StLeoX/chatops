
# 故障注入测试报告分析

## 概述

此报告深入分析了涵盖`user-netdelay`、`frontend-netdelay`和`catalogue-netdelay`的三个核心故障注入演练。在这些演练中，我们专注于CPU使用率、数据包的接收与发送数量（receivePackets和transmitPackets）以及带宽（receiveBandwidth和transmitBandwidth）在关键时刻的表现，以评估系统在面对网络延迟时的表现。

## 1. `user-netdelay` 演练分析

### 1. `user-netdelay` 演练

-   **CPU使用率分析**：
    
    -   在正常情况下，CPU使用率保持在0.17%至0.36%的稳定范围内。
    -   但在2023-11-06 15:21:11，我们观察到一个异常峰值，CPU使用率突然飙升至26.0%，持续了大约10秒，这是一个显著的异常表现。
-   **数据包处理（receivePackets和transmitPackets）**：
    
    -   正常状态下，接收的数据包数量在343至910个之间波动，发送的数据包数量在293至916个之间。
    -   然而，在2023-11-06 15:21:21，接收数据包数量激增至73853个，而发送数据包数量也同步上升至102270个，持续了约13秒，表明了一个明显的网络流量异常。
-   **带宽使用（receiveBandwidth和transmitBandwidth）**：
    
    -   在日常运行中，接收带宽维持在31.5kB至80.3kB，发送带宽在34.5kB至101.7kB。
    -   但2023-11-06 15:21:06发生了显著变化，接收带宽急剧上升至12.73MB，发送带宽也达到了20.34MB，这一异常状态持续了约15秒，显示了网络延迟的显著影响。

## 2. `frontend-netdelay` 演练分析

### 2. `frontend-netdelay` 演练

-   **CPU使用率分析**：
    
    -   平时CPU使用率在0.26%至0.39%之间波动。
    -   但在2023-11-06 15:21:32，出现了异常，CPU使用率急升至63.0%，并在大约40秒后恢复正常，这表明了显著的性能波动。
-   **数据包处理（receivePackets和transmitPackets）**：
    
    -   正常情况下，接收和发送数据包数量分别维持在266至696个和233至603个之间。
    -   然而，在2023-11-06 15:21:22，接收数据包数量飙升至185449个，发送数据包数量也增至235499个，持续了约32秒，反映出网络延迟引起的显著流量增加。
-   **带宽使用（receiveBandwidth和transmitBandwidth）**：
    
    -   通常接收带宽在20.9kB至55.7kB之间，发送带宽在31.5kB至81.9kB。
    -   但在2023-11-06 15:21:22，接收带宽飙升至586.14MB，发送带宽也达到了189.87MB，这种异常状态持续了约32秒，表明了网络延迟对带宽的巨大影响。

## 3. `catalogue-netdelay` 演练分析

### 3. `catalogue-netdelay` 演练

-   **CPU使用率分析**：
    
    -   一般来说，CPU使用率保持在0.16%至0.23%之间。
    -   但在2023-11-06 15:21:31，出现了显著波动，CPU使用率升至22.0%，这一异常持续了约45秒，显示了处理能力的临时压力。
-   **数据包处理（receivePackets和transmitPackets）**：
    
    -   正常运行时，接收和发送数据包数量相对平稳。
    -   异常出现在2023-11-06 15:21:46，接收数据包数量增至65566个，发送数据包达到92523个，这一变化持续了约38秒，反映了网络延迟期间数据包处理的显著变化。
-   **带宽使用（receiveBandwidth和transmitBandwidth）**：
    
    -   在正常情况下，接收带宽和发送带宽保持稳定。
    -   但在2023-11-06 15:21:06，带宽使用发生了显著变化，接收带宽达到了586.14MB，发送带宽为189.87MB，这一状态持续了约40秒，凸显了带宽使用在网络延迟期间的异常表现。

## 总结与系统问题分析

### 用户期望分析

#### 登录模块

-   **CPU使用率**：在`user-netdelay`演练中，`user-64856bf58f-7zngw`节点的CPU使用率在2023-11-06 15:21:11飙升至26.0%，远低于设定的最大阈值80%，此期望满足。

#### 商品目录模块

-   **网络带宽接收（receiveBandwidth）**：在`catalogue-netdelay`演练中，`catalogue-6bc98b6c5b-qlfh4`节点的接收带宽在2023-11-06 15:21:21大幅上升，远超正常水平。这表明receiveBandwidth在网络延迟期间没有保持在正常水平的±20%以内，不符合用户期望。
-   **网络带宽发送（transmitBandwidth）**：同样，在`catalogue-netdelay`演练中，发送带宽在2023-11-06 15:21:31显著上升，违反了用户期望中transmitBandwidth应在演练期间保持稳定的要求。
-   **网络包接收（receivePackets）**：`catalogue-6bc98b6c5b-qlfh4`节点在2023-11-06 15:21:32接收数据包数量大幅上升，远超正常范围，不符合用户期望中receivePackets应保持在正常范围内的要求。
-   **网络包发送（transmitPackets）**：同样，在2023-11-06 15:21:44，发送数据包数量大幅上升，超出正常范围，违反了用户期望中transmitPackets数应保持稳定的要求。

### 系统问题分析

-   **CPU使用率突增**：在所有演练中，特定时刻的CPU使用率的显著上升表明，当系统面对故障时，资源利用率大幅提高。
-   **数据包数量和带宽的异常增加**：网络故障注入可能导致了数据传输的不稳定性，这可能源于网络拥堵或不恰当的流量管理策略。
-   **潜在问题的具体位置**：在`user-netdelay`演练中，2023-11-06 15:21:11的数据波动突出，显示了系统在应对网络延迟时的脆弱性。同样，在`frontend-netdelay`和`catalogue-netdelay`演练中，2023-11-06 15:21:48至2023-11-06 15:24:48的数据波动也指出了网络延迟方面的潜在问题。

综合来看，这些演练结果指出了系统在处理网络延迟方面的潜在缺陷，提示我们需要进一步优化网络流量管理和资源分配策略，以增强系统的稳定性和鲁棒性
